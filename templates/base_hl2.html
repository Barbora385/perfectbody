{% load static %
<!DOCTYPE html>}
<html
    {% if LANGUAGE_CODE %}
        lang="{{ LANGUAGE_CODE }}"
    {% else %}
        lang="cs"
    {% endif %}
>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Perfect Body{% endblock %}</title>
    {% load bootstrap5 %}
    {% bootstrap_css %}
    {% bootstrap_javascript %}

    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"> -->
    <link rel="stylesheet" href="{% static 'styles.css' %}">

</head>

<body>
<div>
    <!-- Navbar -->
    {% include "navbartop.html" %}
    {% include "navbar.html" %}
    <!-- Vyhledavani odstraněno-->
<!-- Blok pro vkládání stránek z navbaru -->
    <div class="container mt-4">
        {% block content %}
        {% endblock %}
    </div>


    <div class="container body-image">

        <!-- Zprávy -->
        {% if messages %}
        <ul class="messages">
            {% for message in messages %}
                <li class="{{ message.tags }}">{{ message }}</li>
            {% endfor %}
        </ul>
        {% endif %}

        <div id="menu-left" class="page-main">
            <!-- Left menu -->
            {% include "navleft.html" %}
            <!--<nav class="jumbotron sidebar-navigation" data-actions="navigation"></nav> -->

            <!-- Right jumbotron -->
            <div class="container">
                {% block content %}
                {% endblock %}
            </div>
        </div>
    </div>

    <!-- Footer -->
    {% include "footer.html" %}

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const searchInput = document.getElementById('search-input');
        const searchResults = document.getElementById('search-results');

        searchInput.addEventListener('input', () => {
            const query = searchInput.value.trim();

            if (query.length > 0) {
                fetch(`/search?q=${encodeURIComponent(query)}`, {
                    method: 'GET',
                    headers: { 'X-Requested-With': 'XMLHttpRequest' },
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        displayResults(data.results);
                    }
                })
                .catch(error => {
                    console.error('Chyba při vyhledávání:', error);
                });
            } else {
                searchResults.style.display = 'none';
            }
        });

        document.addEventListener('click', (event) => {
            if (!searchInput.contains(event.target) && !searchResults.contains(event.target)) {
                searchResults.style.display = 'none';
            }
        });

        function displayResults(results) {
            let html = '';

            if (results.products.length > 0) {
                html += '<h3>Produkty</h3><ul>';
                results.products.forEach(product => {
                    html += `<li><a href="${product.url}">${product.name}</a> - ${product.description}</li>`;
                });
                html += '</ul>';
            }

            if (results.services.length > 0) {
                html += '<h3>Služby</h3><ul>';
                results.services.forEach(service => {
                    html += `<li><a href="${service.url}">${service.name}</a> - ${service.description}</li>`;
                });
                html += '</ul>';
            }

            if (results.trainers.length > 0) {
                html += '<h3>Trenéři</h3><ul>';
                results.trainers.forEach(trainer => {
                    html += `<li><a href="${trainer.url}">${trainer.name}</a></li>`;
                });
                html += '</ul>';
            }

            if (!html) {
                html = '<p>Žádné výsledky.</p>';
            }

            searchResults.innerHTML = html;
            searchResults.style.display = 'block';
        }
    });
    </script>
</div>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script> </body>
</body>

</html>
